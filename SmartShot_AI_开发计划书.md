# ⚽ 智能足球高位追踪支架（SmartShot AI）开发计划书

## 1. 项目定位
- 本项目旨在打造一款低成本、高智能的足球比赛自动拍摄支架。通过 2 米高位视角克服遮挡，利用 AI 全场视野分析锁定比赛球，并以性价比舵机方案实现平稳追踪。

## 2. 核心架构设计

### 2.1 硬件方案（方案 A：性价比路径）
- 主控单元：树莓派 Zero 2W（运行轻量化 YOLOv8）。
- 执行系统：双轴金属舵机云台（DS3218 20kg 级别）。
- 传感器：独立 160° 广角 CSI 摄像头（安装在 2 米三脚架顶端，随动）。
- 供电：移动充电宝（支持 PD 快充输出）。

### 2.2 软件算法（方案 C：智能追踪）
- 识别引擎：YOLOv8-Nano（量化加速版）。
- 逻辑层：运动矢量分析（区分备用球与比赛球）、遮挡惯性预测
- 控制层：PID 平滑算法，消除舵机启停抖动。

## 3. 开发阶段规划（重点：Sim-to-Real）

### 第一阶段：Webots 仿真开发（当前阶段）
- 目标：在零硬件成本下完成 90% 的代码编写与参数调优。
- 任务 1：使用 Trae 编写 Webots 世界脚本，搭建虚拟球场、2 米支架及随机移动的足球。
- 任务 2：在仿真中实现 PID 自动调参脚本，寻找最能跟上射门速度且不晃动的参数组合。
- 任务 3：导出模拟环境下的训练数据，预热 AI 模型。

### 第二阶段：硬件采购与组装
- 任务 1：按照清单采购树莓派、舵机、三脚架。
- 任务 2：利用 Trae 辅助编写树莓派环境初始化脚本（配置国内镜像源 npmmirror）。
- 任务 3：物理组装，确保 2 米高度下的配重平衡（挂载配重袋）。

### 第三阶段：代码迁移与实战测试
- 任务 1：将 Webots 里的 PID 逻辑通过 Trae 迁移至真实 GPIO 控制代码。
- 任务 2：进行“视频回放测试”，用摄像头对着球赛转播画面跑自动化脚本。
- 任务 3：球场实测，记录丢球点并进行最后的代码微调。

## 4. Trae 协作指令指南（Prompts）

### 场景 1：启动仿真环境
```
Trae，我要开始‘智能足球支架’的仿真阶段。请帮我编写一个 Webots Python 控制器代码：

定义两个电机轴（Yaw 和 Pitch）及一个 Camera 传感器。

编写一个基础逻辑，读取 Camera 画面中足球的坐标。

使用 PID 算法驱动电机，使足球始终处于画面中心。
```

### 场景 2：自动化调参
```
Trae，在上面的控制器基础上，增加一个‘自动发球’函数。让足球随机在场景内高速弹出，并自动记录支架追踪的成功率。尝试不同的 P/I/D 参数组合，最后打印出最稳定的一组。
```

### 场景 3：环境配置（针对树莓派）
```
Trae，我准备在树莓派 Zero 2W 上部署代码了。请帮我写一个 Shell 脚本，自动更换为国内镜像源，并安装 OpenCV、Ultralytics 以及控制舵机所需的 GPIO 库，注意关闭不必要的代理设置。
```

## 5. 项目风险控制
- 震动问题：高位支架易晃。对策：在代码中加入“死区设置（Deadzone）”，小范围位移不触发电机，大范围位移平滑启动。
- 光线问题：傍晚比赛识别率下降。对策：增加“球员位置”辅助逻辑，即便球看不清，也优先锁定球员密集的区域。

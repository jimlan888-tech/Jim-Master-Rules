# 自主审计报告（2026-01-27）

## 行为考古（时间线与技术路线）
- 初始化仿真：搭建世界与设备，创建双轴电机与 Camera，设定控制器为 tracker（见 [soccer_field.wbt](file:///d:/Jim/AI_Trading/SmartShot%20AI/sim/worlds/worlds/soccer_field.wbt#L19-L45)）。
- 控制逻辑：实现 PID、死区与增量更新，加入输入熔断（100px）与速度/角度限幅，记录指标（见 [main.py](file:///d:/Jim/AI_Trading/SmartShot%20AI/sim/worlds/controllers/tracker/main.py)）。
- 自动调参：编写仿真网格搜索，输出最优 PID 并写回配置（见 [pid_tuner](file:///d:/Jim/AI_Trading/SmartShot%20AI/sim/controllers/pid_tuner/main.py) 与 [pid.yaml](file:///d:/Jim/AI_Trading/SmartShot%20AI/config/pid.yaml)）。
- 资产管理：统一配置与日志路径，metrics 输出到 logs/，监控物理延迟目标 < 5px（见 [monitoring.txt](file:///d:/Jim/AI_Trading/SmartShot%20AI/logs/monitoring.txt)）。
- 路径修复：将控制器目录迁移到 Webots 识别的 sim/worlds/controllers/tracker，并修正世界文件的 controller 引用。
- 识别修复：为 Camera 增加 Recognition 节点与设备名，避免 recognitionEnable 报错（见 [soccer_field.wbt](file:///d:/Jim/AI_Trading/SmartShot%20AI/sim/worlds/worlds/soccer_field.wbt#L36-L38)）。

## 核心阻碍与解决
- 控制器未发现：误将控制器置于 sim/worlds/worlds/controllers，Webots 实际搜索 sim/worlds/controllers。解决：目录迁移并校正 controller "tracker"。
- 世界保存覆盖：关闭 Webots 保存后曾回写控制器为 <none>。解决：重设 controller "tracker" 并以项目文件夹方式打开 sim/worlds。
- 识别 API 报错：Camera 无 Recognition 节点。解决：为 Camera 添加 recognition 子节点并命名为 "camera"。
- 工具链超时：IDE 执行目录列出与移动命令超时。解决：改用直接文件写入与谨慎路径计算。

## 逻辑推演与偏差分析
- 初始路径假设偏差：将控制器放于仿真子层级导致 Webots 搜索失败。认识到 Webots 项目根的定位与 controllers 同级约定。
- 识别依赖偏差：默认可用 recognitionEnable，在无 Recognition 节点时失败。认识到设备树声明的重要性，需在世界文件层显式开启。
- 物理平滑经验：死区可显著降低启停抖动；熔断忽略单帧突变可抑制误跟踪；增量式位置更新比“直接对齐”更稳定。
- 监控指标设计：采用近 50 帧平均误差作为物理延迟指标，并记录到日志以便审计。

## 最佳实践与后续计划
- 路径规范：控制器目录固定为 sim/worlds/controllers/<name>，世界文件 controller 使用该名称。
- 设备声明：在世界文件中为 Camera 添加 name 与 Recognition，控制器中以相同 name 获取设备。
- 平滑参数：保持 deadzone=3.0，熔断阈值=100px；根据场景再做微调。
- 审计与日志：运行期间写入 logs/tracker_metrics.csv 与 logs/monitoring.txt；调参输出 logs/pid_tuning.csv。
- 下一步：扩展数据导出与 YOLO 预热，验证在不同光照与遮挡下的鲁棒性（见 [dataset_export.py](file:///d:/Jim/AI_Trading/SmartShot%20AI/sim/utils/dataset_export.py)）。
